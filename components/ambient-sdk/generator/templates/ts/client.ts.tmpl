// Code generated by ambient-sdk-generator from openapi.yaml â€” DO NOT EDIT.
// Source: {{.Header.SpecPath}}
// Spec SHA256: {{.Header.SpecHash}}
// Generated: {{.Header.Timestamp}}

import type { AmbientClientConfig, ListOptions, RequestOptions } from './base';
import { ambientFetch, buildQueryString } from './base';
import type { {{.Resource.Name}}, {{.Resource.Name}}List, {{.Resource.Name}}CreateRequest{{if .Resource.HasPatch}}, {{.Resource.Name}}PatchRequest{{end}}{{if .Resource.HasStatusPatch}}, {{.Resource.Name}}StatusPatchRequest{{end}} } from './{{.Resource.Name | snakeCase}}';

export class {{.Resource.Name}}API {
  constructor(private readonly config: AmbientClientConfig) {}

  async create(data: {{.Resource.Name}}CreateRequest, opts?: RequestOptions): Promise<{{.Resource.Name}}> {
    return ambientFetch<{{.Resource.Name}}>(this.config, 'POST', '/{{.Resource.PathSegment}}', data, opts);
  }

  async get(id: string, opts?: RequestOptions): Promise<{{.Resource.Name}}> {
    return ambientFetch<{{.Resource.Name}}>(this.config, 'GET', `/{{.Resource.PathSegment}}/${id}`, undefined, opts);
  }

  async list(listOpts?: ListOptions, opts?: RequestOptions): Promise<{{.Resource.Name}}List> {
    const qs = buildQueryString(listOpts);
    return ambientFetch<{{.Resource.Name}}List>(this.config, 'GET', `/{{.Resource.PathSegment}}${qs}`, undefined, opts);
  }

{{- if .Resource.HasPatch}}
  async update(id: string, patch: {{.Resource.Name}}PatchRequest, opts?: RequestOptions): Promise<{{.Resource.Name}}> {
    return ambientFetch<{{.Resource.Name}}>(this.config, 'PATCH', `/{{.Resource.PathSegment}}/${id}`, patch, opts);
  }
{{end}}
{{- if .Resource.HasDelete}}
  async delete(id: string, opts?: RequestOptions): Promise<void> {
    return ambientFetch<void>(this.config, 'DELETE', `/{{.Resource.PathSegment}}/${id}`, undefined, opts);
  }
{{end}}
{{- if .Resource.HasStatusPatch}}
  async updateStatus(id: string, patch: {{.Resource.Name}}StatusPatchRequest, opts?: RequestOptions): Promise<{{.Resource.Name}}> {
    return ambientFetch<{{.Resource.Name}}>(this.config, 'PATCH', `/{{.Resource.PathSegment}}/${id}/status`, patch, opts);
  }
{{end}}
{{- range .Resource.Actions}}
  async {{.}}(id: string, opts?: RequestOptions): Promise<{{$.Resource.Name}}> {
    return ambientFetch<{{$.Resource.Name}}>(this.config, 'POST', `/{{$.Resource.PathSegment}}/${id}/{{.}}`, undefined, opts);
  }
{{end}}
  async *listAll(size: number = 100, opts?: RequestOptions): AsyncGenerator<{{.Resource.Name}}> {
    let page = 1;
    while (true) {
      const result = await this.list({ page, size }, opts);
      for (const item of result.items) {
        yield item;
      }
      if (page * size >= result.total) {
        break;
      }
      page++;
    }
  }
}
